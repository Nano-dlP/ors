{% extends 'core/index.html' %}
{% load static %}

{% block page_content %}

<!-- Begin Page Content -->
<div class="container-fluid">
  <!-- Page Heading -->
  <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <p class="h5 mb-0 text-gray-800">Listado de Personas</p>
    <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i> Descargar archivo</a>
  </div>

  <!-- Content Row -->
  <div class="row">
    <!-- Content Row -->
    {% block body %}
      <div class="row">
        <!-- Area Chart -->
        <div class="col">
          <div class="card shadow">
            <!-- Card Header - Dropdown -->
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
              <p class="h6 mb-0 text-gray-800 text-primary">PERSONAS</p>
                <div class="dropdown no-arrow">
                  <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                  </a>
                  <!-- Asegúrate de incluir Bootstrap Icons en tu <head> si aún no lo hiciste -->
                  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"> -->

                    <div class="dropdown-menu dropdown-menu-end shadow-lg border-0 p-2 rounded-3" aria-labelledby="dropdownMenuLink" style="min-width: 200px;">
                      <h6 class="dropdown-header text-primary fw-semibold">⚙️ Acciones</h6>
                      <a class="dropdown-item d-flex align-items-center gap-2" href="{% url 'persona:persona_create' %}">
                        <i class="bi bi-plus-circle-fill text-success"></i> Agregar
                      </a>

                      <a class="dropdown-item d-flex align-items-center gap-2" href="#">
                        <i class="bi bi-search text-info"></i> Buscar
                      </a>

                      <a class="dropdown-item d-flex align-items-center gap-2" href="#">
                        <i class="bi bi-printer-fill text-secondary"></i> Imprimir
                      </a>

                      <div class="dropdown-divider"></div>

                      <a class="dropdown-item d-flex align-items-center gap-2 text-danger" href="#">
                        <i class="bi bi-box-arrow-right"></i> Salir
                      </a>
                    </div>

                  </div>
            </div>
            <!-- Card Body -->
            <div class="card-body" style="height: 100%;">
            {% if not personas %}
              <div class="alert alert-warning" role="alert">
              No hay personas registradas.
              </div>
            {% else %}
              <div class="table-responsive table-sm">
                <table class="table table-striped table-hover fs-6" id="id_tabla_inst" width="100%">
                  <thead class="thead-dark">
                    <tr>
                      <th>ID</th>
                      <th>DNI</th>
                      <th>Apellido</th>
                      <th>Nombre</th>
                      <th>Correo</th>
                      <th>Teléfono</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for persona in personas %}
                    <tr>
                      <td>{{ persona.id }}</td>
                      <td>{{ persona.numero_documento }}</td>
                      <td>{{ persona.apellido }}</td>
                      <td>{{ persona.nombre }}</td>
                      <td>{{ persona.email }}</td>
                      <td>{{ persona.telefono }}</td>
                      <td>
                        <a href="{% url 'persona:persona_edit' persona.id %}" class="btn btn-warning btn-circle" title="Editar"><i class="far fa-edit"></i></a>
                        <a href="{% url 'persona:persona_detail' persona.id %}" class="btn btn-info btn-circle" title="Detalles"><i class="fas fa-eye"></i></a>
                        <a href="#" class="btn btn-danger btn-circle disabled" title="Borrar"><i class="far fa-trash-alt"></i></a>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% endblock body %}
  </div>
</div>

{% endblock page_content %}

{% block js_page %}
<script>
  $(document).ready(function () {
    $('#id_tabla_inst').DataTable({
      pageLength: 5,
      lengthMenu: [5, 10, 20, 50],
      language: {
        url: "{% static '/es-ES.json' %}"
      }
    });
  });
</script>
{% endblock js_page %}
